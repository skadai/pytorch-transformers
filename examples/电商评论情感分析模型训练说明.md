### 电商评论情感分析模型训练说明

基于pytorch-transformer库训练电商情感分析模型

## 准备数据集

1. 抽取不同subtype的标注json文件作为正样本
2. 增加排除词作为负样本
3. 增加易混淆的subtype标注语料作为负样本
4. 正负样本组合，划分各subtype的训练集/(验证集)/测试集



### 模型训练

1. 参考配置

   | 参数             | 推荐值 | 参数          | 推荐值      |
   | ---------------- | ------ | ------------- | ----------- |
   | train_batch_size | 16     | weight_decay  | 0.01        |
   | eval_batch_size  | 32     | Adam_epsilon  | 1e-6        |
   | num_train_epochs | 5      | Learning_rate | [2e-5,5e-5] |

   说明

   - epoch:  训练脚本目前没有early stop功能，但是通过设置合理的save step步长保存checkpoint，然后评估模型选择较优的模型，根据之前的经验epoch一般大于5后指标增长缓慢甚至出现负增长

     

2. 目前训练脚本模型启动了mlflow 功能，会将模型训练参数以及training loss等信息写入mlflow server，mlflow server可通过 http://172.16.24.32(33):9001访问

3. 



### 模型评估

1. 模型评估分为两部分：
   - 特征词，情感词采用阅读理解模型的评估指标 exact，f1
   - 情感极性采用分类模型的评估指标 precision，recall，f1
2. 评估脚本使用说明
   - 特征词情感词评估
     - 跑模型评估
     - 计算指标
   - 情感极性评估
     - 跑模型评估
     - 计算指标



### 模型部署

- jupyter notebook临时调用，参考模板，替换为你的模型二进制文件和配置文件即可

- 目前部署采用方案是flask+service_stream，支持
  - 分类
  - 阅读理解
  - 电商评论

具体操作步骤如下



